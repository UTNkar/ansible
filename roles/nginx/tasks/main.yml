---
- name: Install dependencies
  apt: name={{ item }} state=present update_cache=yes
  with_items:
    - nginx

- name: Add NGINX configuration
  template: src={{ template }}.nginx.j2 dest=/etc/nginx/sites-available/{{ fqdn }}
  notify:
    - reload nginx

- name: Enable NGINX configuration
  file: path=/etc/nginx/sites-enabled/{{ fqdn }} src=/etc/nginx/sites-available/{{ fqdn }} state=link
  notify:
    - reload nginx

- name: Allow HTTP connections
  ufw: rule=allow port=80 proto=tcp

- name: Allow HTTPS connections
  ufw: rule=allow port=443 proto=tcp
